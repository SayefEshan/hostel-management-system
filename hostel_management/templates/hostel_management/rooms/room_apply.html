{% extends 'hostel_management/base/base.html' %}

{% block title %}Apply for Room {{ room.room_number }} - Hostel Management System{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'hostel_management:dashboard' %}">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{% url 'hostel_management:room_list' %}">Rooms</a></li>
                <li class="breadcrumb-item"><a href="{% url 'hostel_management:room_detail' room.pk %}">Room {{ room.room_number }}</a></li>
                <li class="breadcrumb-item active">Apply</li>
            </ol>
        </nav>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h4><i class="fas fa-plus me-2"></i>Apply for Room {{ room.room_number }}</h4>
            </div>
            <div class="card-body">
                <!-- Room Summary -->
                <div class="alert alert-info">
                    <h6><i class="fas fa-info-circle me-2"></i>Room Details</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <strong>Block:</strong> {{ room.block }}<br>
                            <strong>Floor:</strong> {{ room.floor }}<br>
                            <strong>Type:</strong> {{ room.get_room_type_display }}
                        </div>
                        <div class="col-md-6">
                            <strong>Capacity:</strong> {{ room.capacity }} beds<br>
                            <strong>Available:</strong> {{ room.available_beds }} beds<br>
                            <strong>Facilities:</strong> 
                            {% if room.has_attached_bathroom %}Attached Bathroom{% endif %}
                            {% if room.has_ac %}{% if room.has_attached_bathroom %}, {% endif %}AC{% endif %}
                            {% if not room.has_attached_bathroom and not room.has_ac %}Basic{% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Application Form -->
                <form method="post">
                    {% csrf_token %}
                    
                    {% if form.non_field_errors %}
                        <div class="alert alert-danger">
                            {{ form.non_field_errors }}
                        </div>
                    {% endif %}
                    
                    <div class="mb-3">
                        <label for="{{ form.preferences.id_for_label }}" class="form-label">
                            <i class="fas fa-comment me-1"></i>Preferences and Requests
                        </label>
                        <textarea class="form-control {% if form.preferences.errors %}is-invalid{% endif %}" 
                                  name="{{ form.preferences.name }}" 
                                  id="{{ form.preferences.id_for_label }}" 
                                  rows="4" 
                                  placeholder="Any specific preferences, roommate requests, or special considerations...">{{ form.preferences.value|default:'' }}</textarea>
                        {% if form.preferences.errors %}
                            <div class="invalid-feedback">
                                {{ form.preferences.errors }}
                            </div>
                        {% endif %}
                        <div class="form-text">{{ form.preferences.help_text }}</div>
                    </div>
                    
                    <!-- Terms and Conditions -->
                    <div class="alert alert-warning">
                        <h6><i class="fas fa-exclamation-triangle me-2"></i>Application Terms</h6>
                        <ul class="mb-0">
                            <li>Your application will be reviewed by hostel administration</li>
                            <li>Room allocation is subject to availability and hostel policies</li>
                            <li>Priority may be given based on academic performance and seniority</li>
                            <li>You will be notified of the decision within 3-5 working days</li>
                            <li>Approved applications require fee payment within 7 days</li>
                        </ul>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="terms" required>
                        <label class="form-check-label" for="terms">
                            I have read and agree to the terms and conditions above
                        </label>
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <a href="{% url 'hostel_management:room_detail' room.pk %}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left me-2"></i>Back to Room Details
                        </a>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-paper-plane me-2"></i>Submit Application
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Application Tips -->
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-lightbulb me-2"></i>Application Tips</h5>
            </div>
            <div class="card-body">
                <div class="small">
                    <h6>Increase your chances:</h6>
                    <ul>
                        <li>Complete your student profile</li>
                        <li>Mention any specific needs clearly</li>
                        <li>Apply early in the semester</li>
                        <li>Keep emergency contacts updated</li>
                    </ul>
                    
                    <h6 class="mt-3">What happens next:</h6>
                    <ol>
                        <li>Application submitted</li>
                        <li>Administrative review</li>
                        <li>Decision notification</li>
                        <li>Fee payment (if approved)</li>
                        <li>Room allocation</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <!-- Contact Info -->
        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="fas fa-phone me-2"></i>Need Help?</h5>
            </div>
            <div class="card-body">
                <p class="small">
                    <strong>Hostel Office:</strong><br>
                    Phone: +880-XXX-XXXXXX<br>
                    Email: hostel@bau.edu.bd<br>
                    Office Hours: 9 AM - 5 PM
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}